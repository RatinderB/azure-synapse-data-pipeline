{
	"name": "Intro Script",
	"properties": {
		"content": {
			"query": "SELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://synapseds.dfs.core.windows.net/taxi-data/Data/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0'\n    ) AS [result]\n\n\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'abfss://taxi-data@synapseds.dfs.core.windows.net/Data/taxi_zone.csv',\n        FORMAT = 'CSV',\n        HEADER_ROW = TRUE,\n        ROWTERMINATOR = '\\n',\n        FIELDTERMINATOR = ',',\n        PARSER_VERSION = '2.0'\n    ) AS [result]\n\n-- abfss://taxi-data@synapseds.dfs.core.windows.net/Data/taxi_zone.csv\n\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'abfss://taxi-data@synapseds.dfs.core.windows.net/Data/taxi_zone.csv',\n        FORMAT = 'CSV',\n        HEADER_ROW = TRUE,\n        ROWTERMINATOR = '\\n',\n        FIELDTERMINATOR = ',',\n        PARSER_VERSION = '2.0'\n    ) \nWITH(\n    LocationID INT,\n    Borough NVARCHAR(15),\n    Zone NVARCHAR(50),\n    service_zone NVARCHAR(15)\n) AS [result]\n\n\n\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK 'abfss://taxi-data@synapseds.dfs.core.windows.net/Data/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR = ',',\n        ROWTERMINATOR = '\\n'\n    ) \n    WITH (\n        LocationID SMALLINT,\n        Borough VARCHAR(15) COLLATE Latin1_General_100_CI_AI_SC_UTF8,\n        Zone VARCHAR(50) COLLATE Latin1_General_100_CI_AI_SC_UTF8,\n        service_zone VARCHAR(15) COLLATE Latin1_General_100_CI_AI_SC_UTF8\n    )AS [result]\n\n\n-- Setting Collation at Database level\n\nALTER DATABASE nyc_taxi_discovery COLLATE Latin1_General_100_CI_AI_SC_UTF8;\n\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK 'abfss://taxi-data@synapseds.dfs.core.windows.net/Data/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR = ',',\n        ROWTERMINATOR = '\\n'\n    ) \n    WITH (\n        Borough NVARCHAR(15),\n        Zone NVARCHAR(50)\n    )AS [result]\n\n\n-- SKipping rows if our data file contains Header /information before the actual data \nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'abfss://taxi-data@synapseds.dfs.core.windows.net/Data/taxi_zone.csv',\n        FORMAT = 'CSV',\n        FIRST_ROW = 5,\n        ROWTERMINATOR = '\\n',\n        FIELDTERMINATOR = ',',\n        PARSER_VERSION = '2.0'\n    ) \nWITH(\n    LocationID INT,\n    Borough NVARCHAR(15),\n    Zone NVARCHAR(50),\n    service_zone NVARCHAR(15)\n) AS [result]\n\n\nCREATE EXTERNAL DATA SOURCE nyc_taxi_data\nWITH(\n    LOCATION = 'abfss://taxi-data@synapseds.dfs.core.windows.net/'\n)\n\nCREATE EXTERNAL DATA SOURCE nyc_taxi_data_raw\nWITH(\n    LOCATION = 'abfss://taxi-data@synapseds.dfs.core.windows.net/Data'\n)\n\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'taxi_zone.csv',\n        DATA_SOURCE = 'nyx_taxi_data_raw',\n        FORMAT = 'CSV',\n        HEADER_ROW = TRUE,\n        ROWTERMINATOR = '\\n',\n        FIELDTERMINATOR = ',',\n        PARSER_VERSION = '2.0'\n    ) \nWITH(\n    LocationID INT,\n    Borough NVARCHAR(15),\n    Zone NVARCHAR(50),\n    service_zone NVARCHAR(15)\n) AS [result]\n\n\nSELECT *\n  FROM OPENROWSET(\n      BULK 'calendar.csv',\n      DATA_SOURCE = 'nyc_taxi_data_raw',\n      FORMAT = 'CSV',\n      PARSER_VERSION = '2.0',\n      HEADER_ROW = TRUE\n  ) AS cal;\n\n\n\nSELECT *\n  FROM OPENROWSET(\n      BULK 'calendar.csv',\n      DATA_SOURCE = 'nyc_taxi_data_raw',\n      FORMAT = 'CSV',\n      PARSER_VERSION = '2.0',\n      HEADER_ROW = TRUE\n  ) \nWITH(\n    date_key        INT,\n    date            DATE,\n    year            SMALLINT,\n    month           TINYINT,\n    day             TINYINT,\n    day_name        VARCHAR(10),\n    day_of_year     SMALLINT,\n    week_of_month   TINYINT,\n    week_of_year    TINYINT,\n    month_name      VARCHAR(10),\n    year_month      INT,\n    year_week       INT\n)AS cal;\n\nSELECT *\nFROM\n    OPENROWSET(\n        BULK 'vendor_unquoted.csv',\n        DATA_SOURCE = 'nyc_taxi_data_raw',\n        FORMAT = 'CSV',\n        HEADER_ROW = TRUE,\n        PARSER_VERSION = '2.0'\n    )AS Vendor\n\nSELECT *\n  FROM OPENROWSET(\n      BULK 'vendor_escaped.csv',\n      DATA_SOURCE = 'nyc_taxi_data_raw',\n      FORMAT = 'CSV',\n      PARSER_VERSION = '2.0',\n      HEADER_ROW = TRUE,\n      ESCAPECHAR = '\\\\'\n  ) AS vendor;\n\n\nSELECT *\n  FROM OPENROWSET(\n      BULK 'vendor.csv',\n      DATA_SOURCE = 'nyc_taxi_data_raw',\n      FORMAT = 'CSV',\n      PARSER_VERSION = '2.0',\n      HEADER_ROW = TRUE,\n      FIELDQUOTE = '\"'\n  ) AS vendor;\n\n\n\n  SELECT *\n  FROM OPENROWSET(\n      BULK 'trip_type.tsv',\n      DATA_SOURCE = 'nyc_taxi_data_raw',\n      FORMAT = 'CSV',\n      PARSER_VERSION = '2.0',\n      HEADER_ROW = TRUE,\n      FIELDTERMINATOR = '\\t'\n  ) AS trip_type;\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "nyc_taxi_discovery",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}